# CodeMap Generate åŠŸèƒ½ä¿®å¤

## é—®é¢˜æè¿°

ç‚¹å‡» "Generate CodeMap" æç¤º "Something went wrong" å’Œ "Command failed with status: exit status: 1"ã€‚

## æ ¹æœ¬åŸå› 

1. **æ¨¡å‹é…ç½®é”™è¯¯**ï¼šä»£ç ä¸­ä½¿ç”¨ `gemini-3-flash` å’Œ `google-antigravity` æä¾›å•†ï¼Œè¿™ä¸¤ä¸ªé…ç½®æ— æ•ˆ
2. **é”™è¯¯å¤„ç†ä¸è¶³**ï¼šå‰ç«¯å’Œåç«¯ç¼ºå°‘è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—
3. **è¶…æ—¶è®¾ç½®å¤ªçŸ­**ï¼š60 ç§’è¶…æ—¶å¯¹äº AI ç”Ÿæˆä¸å¤Ÿ

## ä¿®å¤å†…å®¹

### 1. æ›´æ–°æ¨¡å‹é…ç½®

**æ–‡ä»¶**: `generator/src/providers/PiProvider.ts`

- å°†æ¨¡å‹ä» `gemini-3-flash` æ”¹ä¸º `z-ai/glm4.7`
- å°†æä¾›å•†ä» `google-antigravity` æ”¹ä¸º `nvidia`
- ç§»é™¤æ— æ•ˆçš„å‚æ•°ï¼ˆå¦‚ `--tools read`ï¼‰

### 2. æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—

**æ–‡ä»¶**: `generator/src/providers/PiProvider.ts`

- å¢åŠ è¯¦ç»†çš„æ§åˆ¶å°æ—¥å¿—è¾“å‡º
- å»¶é•¿è¶…æ—¶æ—¶é—´åˆ° 120 ç§’
- æ”¹è¿›é”™è¯¯æ¶ˆæ¯æ ¼å¼

**æ–‡ä»¶**: `client/src/components/MainPanel.tsx`

- æ”¹è¿›é”™è¯¯çŠ¶æ€æ˜¾ç¤º
- åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯ï¼ˆè¶…æ—¶ã€ç½‘ç»œè¿æ¥ç­‰ï¼‰
- æä¾›æ›´å¥½çš„ç”¨æˆ·æŒ‡å¯¼

**æ–‡ä»¶**: `client/src/stores/codemapStore.ts`

- å¢åŠ æ›´è¯¦ç»†çš„æ—¥å¿—è®°å½•
- æ”¹è¿› JSON è§£æé”™è¯¯å¤„ç†

### 3. å®Œå–„ Rust åç«¯

**æ–‡ä»¶**: `client/src-tauri/src/commands.rs`

- å¢åŠ è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—
- æ”¹è¿›é”™è¯¯å¤„ç†
- ä¿®å¤ç¼–è¯‘é”™è¯¯ï¼ˆæ¢å¤å®Œæ•´çš„å‘½ä»¤å®šä¹‰ï¼‰

### 4. éªŒè¯è„šæœ¬

**æ–‡ä»¶**: `test-pi-cli.sh`

- æµ‹è¯• Pi CLI åŸºæœ¬åŠŸèƒ½
- éªŒè¯æ¨¡å‹è¿æ¥

## éªŒè¯æ­¥éª¤

### 1. æµ‹è¯• Pi CLI

```bash
cd ~/.pi/agent/skills/codemap
./test-pi-cli.sh
```

é¢„æœŸè¾“å‡ºï¼š

```
ğŸ§ª Testing Pi CLI...
ğŸš€ Running pi command...
Output: ä½ å¥½ï¼...
âœ… Pi CLI works! Duration: ~4s
```

### 2. å¯åŠ¨åº”ç”¨

```bash
cd ~/.pi/agent/skills/codemap/client
pnpm run tauri:dev
```

### 3. æµ‹è¯•ç”ŸæˆåŠŸèƒ½

1. æ‰“å¼€åº”ç”¨åç‚¹å‡» "New CodeMap"
2. è¾“å…¥æŸ¥è¯¢ï¼šä¾‹å¦‚ "åˆ†æå‰ç«¯ç»„ä»¶ç»“æ„"
3. ç‚¹å‡» "Generate CodeMap"
4. è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—

é¢„æœŸè¡Œä¸ºï¼š

- æŒ‰é’®æ˜¾ç¤º "Generating..." çŠ¶æ€
- æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- 20-60 ç§’åæ˜¾ç¤ºç”Ÿæˆçš„ CodeMap
- å¦‚æœå¤±è´¥ï¼Œæ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

## å·²çŸ¥é™åˆ¶

1. **JSON è§£æé—®é¢˜**ï¼šGLM4 ç”Ÿæˆçš„å†…å®¹å¯èƒ½è¢«æˆªæ–­ï¼Œå¯¼è‡´ JSON ä¸å®Œæ•´
   - ä¸´æ—¶æ–¹æ¡ˆï¼šåœ¨ PiProvider ä¸­æ·»åŠ æ›´å¥½çš„ JSON æå–å’Œä¿®å¤é€»è¾‘
   - é•¿æœŸæ–¹æ¡ˆï¼šè°ƒæ•´æç¤ºè¯æˆ–ä½¿ç”¨æ”¯æŒ streaming çš„æ¨¡å‹

2. **è¶…æ—¶é£é™©**ï¼šå¯¹äºå¤§å‹é¡¹ç›®çš„åˆ†æï¼Œ120 ç§’å¯èƒ½ä»ç„¶ä¸å¤Ÿ
   - å»ºè®®ï¼šåœ¨ UI ä¸­æ˜¾ç¤ºè¿›åº¦å’Œæ—¶é—´
   - è€ƒè™‘å®ç° streaming/progressive æ˜¾ç¤º

## ä¸‹ä¸€æ­¥ä¼˜åŒ–

1. **æµå¼è¾“å‡ºæ”¯æŒ**ï¼šå®ç° progressive renderingï¼Œè¾¹ç”Ÿæˆè¾¹æ˜¾ç¤º
2. **æ›´æ™ºèƒ½çš„å®¹é”™**ï¼šè‡ªåŠ¨ä¿®å¤ä¸å®Œæ•´çš„ JSON
3. **æ›´å¥½çš„è¿›åº¦åé¦ˆ**ï¼šæ˜¾ç¤ºè¯¦ç»†çš„åˆ†ææ­¥éª¤
4. **ç¼“å­˜æœºåˆ¶**ï¼šå¯¹ç›¸åŒæŸ¥è¯¢ç¼“å­˜ç»“æœ

## æŠ€æœ¯æ ˆ

- å‰ç«¯ï¼šReact + Tauri + Zustand
- åç«¯ï¼šRust + Tauri
- ç”Ÿæˆå™¨ï¼šBun + TypeScript
- AI æ¨¡å‹ï¼šz-ai/glm4.7 (NVIDIA)
